===== FILE: src\app\services\auth\login\auth.service.ts =====
import { Injectable } from '@angular/core';
import { HttpClient, HttpHeaders } from '@angular/common/http';
import { Observable, catchError, map, throwError } from 'rxjs';
import { ToastService } from '../../utilities/toast.service';
import { Domain } from '../../../../utilities/path';
import { baseResponse } from '../../../dto/baseResponse';

@Injectable({
  providedIn: 'root'
})
export class AuthService {
  private apiUrl = `${Domain}/api/Auth`;

  constructor(private http: HttpClient, private toast: ToastService) { }

  /** ØªØ§Ø¨Ø¹ Ù„Ø§Ú¯ÛŒÙ† */
  login(email: string, password: string): Observable<any> {
    const body = { email, password };

    return this.http.post<baseResponse<any>>(`${this.apiUrl}/login`, body, {
      headers: new HttpHeaders({ 'Content-Type': 'application/json' })
    }).pipe(
      map(response => {
        if (response.isSucceeded && response.singleData?.token) {
          // Ø°Ø®ÛŒØ±Ù‡ ØªÙˆÚ©Ù† Ø¯Ø± localStorage
          localStorage.setItem('token', response.singleData.token);
          localStorage.setItem('user', JSON.stringify(response.singleData));
        }
        return response;
      }),
      catchError(error => {
        this.toast.showToast.error({ message: 'Ø®Ø·Ø§ Ø¯Ø± ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø³ÛŒØ³ØªÙ…' });
        return throwError(() => error);
      })
    );
  }

  /** Ø®Ø±ÙˆØ¬ Ø§Ø² Ø³ÛŒØ³ØªÙ… */
  logout() {
    localStorage.removeItem('token');
    localStorage.removeItem('user');
  }

  /** Ø¨Ø±Ø±Ø³ÛŒ Ù„Ø§Ú¯ÛŒÙ† Ø¨ÙˆØ¯Ù† Ú©Ø§Ø±Ø¨Ø± */
  isLoggedIn(): boolean {
    return !!localStorage.getItem('token');
  }

  /** Ú¯Ø±ÙØªÙ† ØªÙˆÚ©Ù† Ø°Ø®ÛŒØ±Ù‡â€ŒØ´Ø¯Ù‡ */
  getToken(): string | null {
    return localStorage.getItem('token');
  }
}


===== FILE: src\app\services\base\userManage\user-manage.service.spec.ts =====
import { TestBed } from '@angular/core/testing';

import { UserManageService } from './user-manage.service';

describe('UserManageService', () => {
  let service: UserManageService;

  beforeEach(() => {
    TestBed.configureTestingModule({});
    service = TestBed.inject(UserManageService);
  });

  it('should be created', () => {
    expect(service).toBeTruthy();
  });
});


===== FILE: src\app\services\base\userManage\user-manage.service.ts =====
import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { Domain } from 'src/utilities/path';
import { ToastService } from '../../utilities/toast.service';
import { ListRequest } from 'src/app/dto/ListRequestDto';
import { catchError, Observable, throwError } from 'rxjs';
import { baseResponse } from 'src/app/dto/baseResponse';
import {UserCreateFormData, UserDto} from 'src/app/dto/base/UserDto';
import { BaseService } from '../../utilities/base.service';

@Injectable({
  providedIn: 'root'
})
export class UserManageService  extends BaseService<UserDto, UserDto>{
  protected endpoint = '/api/user';

}


===== FILE: src\app\services\shop\countType\count-type.service.spec.ts =====
import { TestBed } from '@angular/core/testing';

import { CountTypeService } from './count-type.service';

describe('CountTypeService', () => {
  let service: CountTypeService;

  beforeEach(() => {
    TestBed.configureTestingModule({});
    service = TestBed.inject(CountTypeService);
  });

  it('should be created', () => {
    expect(service).toBeTruthy();
  });
});


===== FILE: src\app\services\shop\countType\count-type.service.ts =====
// Angular Imports
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';

// Shared & Utility Imports
import { ToastService } from '../../utilities/toast.service';
import { BaseService } from '../../utilities/base.service';
import { Domain } from 'src/utilities/path';

// DTO Imports
import { CountTypeDto } from './../../../dto/shop/CountTypeDto';
import { ListRequest } from 'src/app/dto/ListRequestDto';
import { baseResponse } from 'src/app/dto/baseResponse';

// RxJS Imports
import { catchError, Observable, throwError } from 'rxjs';


// ==========================================================================
// â¬‡ï¸ Service Definition: CountTypeService
// ==========================================================================
@Injectable({
  providedIn: 'root'
})
export class CountTypeService extends BaseService<CountTypeDto , CountTypeDto> {
protected  endpoint= '/api/counttype';

}


===== FILE: src\app\services\shop\inventory\inventory.service.spec.ts =====
import { TestBed } from '@angular/core/testing';

import { InventoryService } from './inventory.service';

describe('InventoryService', () => {
  let service: InventoryService;

  beforeEach(() => {
    TestBed.configureTestingModule({});
    service = TestBed.inject(InventoryService);
  });

  it('should be created', () => {
    expect(service).toBeTruthy();
  });
});


===== FILE: src\app\services\shop\inventory\inventory.service.ts =====
import { Injectable } from '@angular/core';
import { BaseService } from '../../utilities/base.service';
import { Domain } from 'src/utilities/path';
import { HttpClient } from '@angular/common/http';
import { ToastService } from '../../utilities/toast.service';
import { ListRequest } from 'src/app/dto/ListRequestDto';
import { catchError, Observable, throwError } from 'rxjs';
import { baseResponse } from 'src/app/dto/baseResponse';
import {InventoryDto} from 'src/app/dto/shop/InventoryDto'

@Injectable({
  providedIn: 'root'
})
export class InventoryService extends BaseService<InventoryDto , InventoryDto> {

  protected endpoint='/api/inv';
   

}


===== FILE: src\app\services\shop\product\product.service.spec.ts =====
import { TestBed } from '@angular/core/testing';

import { ProductService } from '../product/product.service';

describe('ProductService', () => {
  let service: ProductService;

  beforeEach(() => {
    TestBed.configureTestingModule({});
    service = TestBed.inject(ProductService);
  });

  it('should be created', () => {
    expect(service).toBeTruthy();
  });
});


===== FILE: src\app\services\shop\product\product.service.ts =====
import { ToastService } from '../../utilities/toast.service';
import { ListRequest } from '../../../dto/ListRequestDto';
import { HttpClient, HttpHeaders } from '@angular/common/http';
import { Domain } from '../../../../utilities/path';
import { Injectable } from '@angular/core';
import { baseResponse } from '../../../dto/baseResponse';
import { catchError, map, Observable, throwError } from 'rxjs';
import { ProductCreateDto, ProductViewDto } from '../../../dto/shop/ProductDto';
import { BaseService } from '../../utilities/base.service';

@Injectable({
  providedIn: 'root'
})
export class ProductService extends BaseService<ProductViewDto, ProductCreateDto> {
  protected endpoint='/api/product';
  private apiurl = Domain;







 

  /** Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…Ø­ØµÙˆÙ„ Ø¨Ø§ Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ */
  searchProducts(request: ListRequest): Observable<baseResponse<ProductViewDto>> {


    return this.http.post<baseResponse<ProductViewDto>>(`${this.apiurl}/api/product/search`, request, { headers: this.getJsonHeaders() }).pipe(
      catchError(error => {
        this.toast.showToast.error({ message: 'Ø®Ø·Ø§ Ø¯Ø± ØªØ±Ø§Ú©Ù†Ø´ ' });

        return throwError(() => error);
      })
    );
  }

}


===== FILE: src\app\services\utilities\base.service.spec.ts =====
// src/app/services/utilities/mock-base.service.ts
import { Injectable } from '@angular/core';
import { BaseService } from './base.service';

@Injectable()
export class MockBaseService extends BaseService<any, any> {
  protected endpoint = '/api/test'; // ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ú©Ø§Ù…Ù¾Ø§ÛŒÙ„ Ø´Ø¯Ù†

  constructor() {
    super(null!, null!); // HttpClient Ùˆ ToastService Ø±Ùˆ null Ù…ÛŒâ€ŒØ°Ø§Ø±ÛŒÙ… Ú†ÙˆÙ† ØªØ³Øª ÙˆØ§Ø­Ø¯ Ù‡Ø³Øª
  }
}

===== FILE: src\app\services\utilities\base.service.ts =====
import { HttpClient, HttpHeaders } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { Observable, catchError, throwError } from 'rxjs';
import { ToastService } from './toast.service'; // ÙØ±Ø¶ Ú©Ù†ÛŒØ¯ Ø§ÛŒÙ† Ø±Ùˆ Ø¯Ø§Ø±ÛŒØ¯
import { baseResponse } from '../../dto/baseResponse'; // Ù†ÙˆØ¹ response Ø¹Ù…ÙˆÙ…ÛŒ
import { ListRequest } from '../../dto/ListRequestDto'; // Ù†ÙˆØ¹ request Ù„ÛŒØ³Øª
import { Domain } from '../../../utilities/path'; // URL Ù¾Ø§ÛŒÙ‡

@Injectable({
  providedIn: 'root'
})
export abstract class BaseService<TViewDto, TCreateDto = TViewDto> { // generics Ø¨Ø±Ø§ÛŒ Ù†ÙˆØ¹ view Ùˆ create
  protected apiUrl = Domain; // URL Ù¾Ø§ÛŒÙ‡
  protected abstract endpoint: string; // Ù‡Ø± Ø³Ø±ÙˆÛŒØ³ Ø®Ø§Øµ Ø§ÛŒÙ† Ø±Ùˆ Ù…Ø´Ø®Øµ Ú©Ù†Ù‡ (Ù…Ø«Ù„ '/api/User')

  constructor(protected http: HttpClient, protected toast: ToastService) {}

  protected getJsonHeaders(): HttpHeaders {
    return new HttpHeaders({
      'accept': 'application/json',
      'Content-Type': 'application/json'
    });
  }

  // Ù…ØªØ¯ Ø¹Ù…ÙˆÙ…ÛŒ Ø¨Ø±Ø§ÛŒ Ù„ÛŒØ³Øª
  getRecords(request: ListRequest): Observable<baseResponse<TViewDto>> {
    return this.http.post<baseResponse<TViewDto>>(
      `${this.apiUrl}${this.endpoint}/GetAll`,
      request,
      { headers: this.getJsonHeaders() }
    ).pipe(
      catchError(error => this.handleError(error))
    );
  }

  // Ù…ØªØ¯ Ø¹Ù…ÙˆÙ…ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯
  insertRecord(data: TCreateDto): Observable<baseResponse<TCreateDto>> {
    return this.http.post<baseResponse<TCreateDto>>(
      `${this.apiUrl}${this.endpoint}/create`,
      data,
      { headers: this.getJsonHeaders() }
    ).pipe(
      catchError(error => this.handleError(error))
    );
  }

  // Ù…ØªØ¯ Ø¹Ù…ÙˆÙ…ÛŒ Ø¨Ø±Ø§ÛŒ Ø­Ø°Ù
  deleteRecords(ids: number[]): Observable<baseResponse<any>> {
    return this.http.post<baseResponse<any>>(
      `${this.apiUrl}${this.endpoint}/delete`,
      ids,
      { headers: this.getJsonHeaders() }
    ).pipe(
      catchError(error => this.handleError(error))
    );
  }

  // Ù…ØªØ¯ Ø¹Ù…ÙˆÙ…ÛŒ Ø¨Ø±Ø§ÛŒ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
  updateRecord(data: TCreateDto): Observable<baseResponse<TCreateDto>> {
    return this.http.post<baseResponse<TCreateDto>>(
      `${this.apiUrl}${this.endpoint}/update`,
      data,
      { headers: this.getJsonHeaders() }
    ).pipe(
      catchError(error => this.handleError(error))
    );
  }

  // Ù…ØªØ¯ Ø¹Ù…ÙˆÙ…ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª ØªÚ© Ø±Ú©ÙˆØ±Ø¯
  getRecordById(id: number): Observable<baseResponse<TCreateDto>> {
    return this.http.get<baseResponse<TCreateDto>>(
      `${this.apiUrl}${this.endpoint}/getById/?id=${id}`,
      { headers: this.getJsonHeaders() }
    ).pipe(
      catchError(error => this.handleError(error))
    );
  }

  // Ù‡Ù†Ø¯Ù„Ø± Ø¹Ù…ÙˆÙ…ÛŒ Ø®Ø·Ø§
  protected handleError(error: any): Observable<never> {
    this.toast.showToast.error({ message: 'Ø®Ø·Ø§ Ø¯Ø± ØªØ±Ø§Ú©Ù†Ø´' });
    return throwError(() => error);
  }


  getCreateForm<TForm>(): Observable<baseResponse<TForm>> {
    return this.http.get<baseResponse<TForm>>(
      `${this.apiUrl}${this.endpoint}/getcreateform`,
      { headers: this.getJsonHeaders() }
    ).pipe(
      catchError(error => this.handleError(error))
    );
  }
}

